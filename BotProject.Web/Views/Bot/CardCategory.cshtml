@model IEnumerable<BotProject.Web.Models.ModuleViewModel>
@{
    ViewBag.Title = "CardCategory";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="https://cdnjs.cloudflare.com/ajax/libs/jquery.selectboxit/3.8.0/jquery.selectBoxIt.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/css/select2.min.css" rel="stylesheet" />
<link href="~/assets/client/css/card.css" rel="stylesheet" />
<link href="~/assets/client/css/components.css" rel="stylesheet" />
<link href="~/assets/client/libs/emoji-picker/css/emoji.css" rel="stylesheet" />

<style>
    .aside-nav .nav li a.active {
    background-color: cornsilk;
    color: black;
}
</style>
<input type="hidden" id="botId" value="@ViewBag.BotID" />

<div id="block-card">
    <div class="row">
        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
            <div class="card">
                <div class="d-flex">
                    <h5 class="pageheader-title p-l-10 p-t-10">Thiết lập thẻ</h5>
                </div>
                <div>
                    <div class="card-body">
                        <div class="content-wrapper">
                            <!-- Form horizontal -->
                            <div class="panel panel-flat">
                                <div class="panel-body">
                                    <div id="build">
                                    </div>
                                    <hr>
                                    <button type="button" class="btn btn-default addBlock" onclick="addBlock()"><i class="icon-plus22 fa fa-plus"></i> Thêm Nhóm</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="layout-card" style="display:none">
    <aside class="page-aside">
        <div class="aside-content">
            <div class="aside-header">
                <button class="navbar-toggle" data-target=".aside-nav" data-toggle="collapse" type="button">
                    <span class="icon"><i class="fas fa-caret-down"></i></span>
                </button>
                <span class="title"><i class="fa fa-arrow-left" style="font-size:11px"></i> <span id="groupCardName" style="text-decoration:underline;cursor:pointer;"></span><span style="float:right;cursor:pointer;" id="btn-create-card"><i class="fa fa-plus-circle"></i></span></span>
                <p class="description">Tạo thẻ trả lời cho bot</p>
            </div>
            <div class="aside-nav collapse">
                <ul class="nav" id="lst-card">

                </ul>
            </div>
        </div>
    </aside>
    <div class="main-content container-fluid p-0" id="form-card" style="display:none;">
        <input type="hidden" id="idCard" value="" />
        <div class="card-head">
            <div class="card-head-title">
                <div class="title">
                    <a class="active" href="#"><span class="icon"><i class="fas fa-pencil-alt"></i></span></a>
                    <span><input type="text" maxlength="25" id="card-name" placeholder="Tên Thẻ" autocomplete="off"></span>
                    <div></div>
                    <div class="icons">
                        <a href="#" class="icon" id="save_card">
                            <i class="fas fa-save"></i>
                        </a>
                        <a href="#" class="icon">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="card-head-template">
                <div class="addCard">
                    <ul class="list-inline">
                        <li class="card_galery"><i class="fa fa-copy"></i><span>Thẻ hình và chữ</span></li>
                        <li class="card_text"><i class="fa fa-file"></i><span>Thẻ văn bản</span></li>
                        <li class="card_list disable"><i class="fa fa-list-alt"></i><span>Danh sách</span></li>
                        <li class="card_image"><i class="fa fa-image"></i><span>Hình ảnh</span></li>
                        <li class="card_file disable"><i class="fa fa-file-archive"></i><span>Tệp tin</span></li>
                        <li class="card_quickReply"><i class="fa fa-flickr"></i><span>Trả lời nhanh</span></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="card-body">
            <div id="wr_multi" class="scroll">
                <div id="multi">
                </div>
            </div>
        </div>
        <div class="card-quickreply">
            <div id="wr_reply" style="display: none;">
                <h3><i class="icon-primitive-dot position-left"></i>Trả lời nhanh <span class="rm_wrReply"><i class="icon-bin"></i></span></h3>
                <ul id="blReply" class="list-inline">
                    <li class="add_reply">
                        <div class="name-button"><i class="icon-plus2 fa fa-plus position-left"></i> Thêm trả lời nhanh</div>
                    </li>
                </ul>
            </div>
        </div>
        <div id="modal_button" class="modal fade in" style="display: none;">

        </div>
    </div>
</div>

@section footerJS{

    <script>
        var lstModule = @Html.Raw(Json.Encode(Model));
        console.log(lstModule)
        function module() {
            var html = '';
            if (lstModule.length != 0) {
                $.each(lstModule, function (index, value) {
                    html += '<option value="'+value.Key+'">'+value.Title+'</option>';
                })
            }else{
                html += '<option value=""></option>';
            }
            return html;
            //var htmlListModule = '<option  value="vote">Bình chọn</option><option  value="livechat">Chat trực tiếp</option><option attr-template="true" value="rss">RSS</option><option attr-template="true" value="weather">Thời tiết</option><option  value="reservation">Đặt bàn</option>';
            //return htmlListModule;
        }

    </script>
    <script src="~/assets/client/js/eventBot/form-card.js"></script>
    <!--Icon Chat-->
    <script src="~/assets/client/libs/emoji-picker/js/config.js"></script>
    <script src="~/assets/client/libs/emoji-picker/js/util.js"></script>
    <script src="~/assets/client/libs/emoji-picker/js/jquery.emojiarea.js"></script>
    <script src="~/assets/client/libs/emoji-picker/js/emoji-picker.js"></script>
    <script>
        $(function () {
            window.emojiPicker = new EmojiPicker({
                emojiable_selector: '[data-emojiable=true]',
                //assetsPath: '../asset/emoji-picker/img',
                assetsPath: _Host + 'assets/client/libs/emoji-picker/img',
                popupButtonClasses: 'fa fa-cogs'
            });
            window.emojiPicker.discover();

            // auto show thread form in
            $('.auto-form .inp-title').bind('focus', function (event) {
                var element = $(event.currentTarget);
                var container = element.closest('.auto-form');
                var select = container.find('.cat-dropdown');
                var bottom = container.find('.form-detail');
                var cancel = container.find('.cancel');

                if (!container.hasClass('opened')) {
                    container.addClass('opened');
                    select.fadeIn().removeClass('hide');
                    bottom.slideDown();
                    cancel.unbind('click').bind('click', function (event) {
                        event.preventDefault();
                        container.removeClass('opened');
                        select.fadeOut();
                        bottom.slideUp();
                        //hide preview when cancel button clicked
                        $('.skin-checkbox').removeClass('checked');
                        $("div#thread_preview").fadeOut();
                        $("ul#main_list_post").fadeIn();
                        $("#main_pagination").fadeIn();
                        $('.show-preview a').text('Show Preview');
                    });
                }
            });
            // auto render categories dropdown
            $('.thread-form .cat-dropdown').each(function () {
                var element = $(this);
                var selector = element.find('select');
                var listDropdown = $('<ul>').addClass('dropdown-menu category-select');
                var label = element.find('.text-select');
                var i = 0;

                // set default text
                label.html(selector.find('option:selected').text());

                // build list
                selector.find('option').each(function () {
                    var option = $(this);
                    var listItem = $('<li>').text(option.text()).attr('data-value', option.attr('value'));
                    // add event for listItem
                    listItem.bind('click', function () {

                        selector.val($(this).attr('data-value'));
                        label.text($(this).text());
                        $("#thread_preview span.type-category").html('<span class="flags color-2"></span>' + option.text());
                    });
                    if (i > 0) {
                        listDropdown.append(listItem);
                    }
                    i++;
                });

                // add list to
                if (!selector.next().is('ul')) {
                    selector.after(listDropdown);
                }
            });
        });
    </script>
}


